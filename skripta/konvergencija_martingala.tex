% konvergencija martingala, cjelina 5.4 -> predavanje 24

\chapter{Konvergencija martingala}

Razmislimo o jednostavnoj strategiji prilikom igranja neke igre opisane submartingalom ili martingalom.
Na\v sa strategija \'ce biti ili "propu\v stamo igru na temelju postoje\' cih informacija" ili "ulazimo u igru ne temelju postoje\' cih informacija".
Slijede\' ci teorem ka\v ze da kako god izabrali takvu "strategiju propu\v stanja igre", ne\' cemo promijeniti prirodu igre.

\begin{tm}[Halmos, "optimal skipping theorem"]  \label{tm:24.1}
    \quad \\
    Neka je $\niz{X_n}{n \in \nat}$ submartingal (martingal) u odnosu na filtraciju $\indFamilija{\famF_n}{n \in \nat}$.
    Neka je $\indFamilija{B_n}{n \in \nat}$ niz Borelovih skupova, tako da je $B_n \in \borel{\real^n}$, za svaki $n \in \nat$.
    Neka su slu\v cajne varijable $\varepsilon_1, \varepsilon_2, \ldots$ definirane sa
    \begin{equation*}
        \varepsilon_k :=
        \begin{cases}
            1 &, (X_1, \ldots, X_k) \in B_k\\
            0 &, (X_1, \ldots, X_k) \notin B_k
        \end{cases},
    \end{equation*}
    i $\niz{Y_n}{n \in \nat}$ niz slu\v cajnih varijabli definiranih sa
    \begin{equation*}
        \begin{gathered}
            Y_1 := X_1,\\
            Y_{k + 1} := Y_k + \varepsilon_k \cdot (X_{k + 1} - X_k).
        \end{gathered}
    \end{equation*}
    Tada je $(Y_n)$ submartingal (martingal) u odnosu na filtraciju $\indFamilija{\famF_n}{n \in \nat}$ i vrijedi $\masE Y_n \leq \masE X_n$ ($\masE Y_n = \masE X_n$), za svaki $n \in \nat$.
\end{tm}

\begin{proof}
    O\v cito je $\varepsilon_n$ $\famF_n$-izmjeriva, pa je $(Y_n)$ $\{\famF_n\}$-adaptiran niz iz $L^1(\masP)$.
    Uo\v cimo da je $\masE Y_1 = \masE X_1$ i promotrimo
    \begin{equation*}
        \begin{gathered}
            \masE [Y_{n + 1} | \famF_n] = Y_n + \varepsilon_n \cdot \masE [X_{n + 1} - X_n | \famF_n]\\
            \begin{aligned}
                \textnormal{submartingal} &\implies \masE [X_{n + 1} - X_n | \famF_n] \geq 0\\
                \textnormal{martingal} &\implies \masE [X_{n + 1} - X_n | \famF_n] = 0.
            \end{aligned}
        \end{gathered}
    \end{equation*}
    Primjetimo
    \begin{equation*}
        X_{n + 1} - Y_{n + 1} = (1 - \varepsilon_n) (X_{n + 1} - X_n) + (X_n - Y_n),
    \end{equation*}
    slijedi
    \begin{equation*}
        \masE [X_{n + 1} - Y_{n + 1} | \famF]
        \begin{smallmatrix}
            \geq\\
            (=)
        \end{smallmatrix}
        \masE [X_n - Y_n | \famF_n] = X_n - Y_n,
    \end{equation*}
    odakle vidimo da vrijedi
    \begin{equation*}
        \masE [X_{n + 1} - Y_{n + 1}]
        \begin{smallmatrix}
            \geq\\
            (=)
        \end{smallmatrix}
        \masE [X_n - Y_n]
    \end{equation*}
    \v sto daje tvrdnju.
\end{proof}

Ako je $x_1, \ldots, X_n$ niz brojeva i $\obInt{a}{b}$ otvoreni interval.
Mo\v zemo brojati koliko puta ovaj niz "presko\v ci" $\obInt{a}{b}$ prema gore.
Stavimo
\begin{equation*}
    \begin{aligned}
        T_1 &:=
        \begin{cases}
            \min \indFamilija{k}{1 \leq k \leq n, \; x_k \leq a}\\
            +\infty, \quad \indFamilija{k}{1 \leq k \leq n, \; x_k \leq a} = \varnothing
        \end{cases},\\
        T_2 &:=
        \begin{cases}
            \min \indFamilija{k}{T_1 < k \leq n, \; x_k \geq b}\\
            +\infty, \quad \indFamilija{k}{T_1 < k \leq n, \; x_k \geq b} = \varnothing
        \end{cases}.
    \end{aligned}
\end{equation*}
Neka je
\begin{equation*}
    N := \mathrm{card} \indFamilija{1 \leq k \leq n}{T_k < +\infty},
\end{equation*}
uz konvenciju $\mathrm{card} \varnothing = +\infty$.
Stavimo
\begin{equation*}
    U_{a b} :=
    \begin{cases}
        \frac{N}{2},& N \textnormal{ paran}\\
        \frac{N + 1}{2},& N \textnormal{ neparan}\\
        0,& N = +\infty
    \end{cases}
\end{equation*}

\begin{tm}[J. L. Doob, "upcrossing theorem"]    \label{tm:24.2}
    \quad \\
    Neka su $a, b \in \real$, $a < b$ i neka je $\niz{X_k}{k = 1, \leq, n}$ submartingal u odnosu na filtraciju $\indFamilija{\famF_k}{k = 1, \ldots, n}$.
    Neka je $U_{a b}$ slu\v cajna varijabla definirana pomo\' cu $X_1, \ldots, X_n$.
    Tada je
    \begin{equation*}
        \masE [U_{a b}] \leq \frac{1}{b - a} \masE [(X_n - a)^+].
    \end{equation*}
\end{tm}

\begin{proof}
    Budu\' ci da je $\niz{(X_k - a)^+}{k = 1, \ldots, n}$ ponovo submartingal te pripadni $U_{0, b - a}$ je isti kao i $U_{a b}$ za polazni submartingal $(X_k)$, bez smanjenja op\' cenitosti mo\v zemo pretpostaviti da je $a = 0$ i $X_k \geq 0$, za svaki $k$ ura\v cunajmo samo preskoke prema gore, to jest u teoremu \ref{tm:24.1} biramo $\varepsilon_j$ tako da je $\varepsilon_j = 0$ za $j < T_1$, $\varepsilon_j = 1$, za $T_1 \leq j < T_2$, $\varepsilon_j = 0$, za $T_2 \leq j < T_3$, to jest ako je $i \in \nat$, tada
    \begin{equation*}
        \varepsilon_j =
        \begin{cases}
            1 ,& T_{2 i - 1} \leq j < T_{2 i}\\
            0 ,& \textnormal{ina\v ce}
        \end{cases}.
    \end{equation*}
    Slijedi da je
    \begin{equation*}
        Y_n \geq b U_{0, b},
    \end{equation*}
    odakle dobijemo
    \begin{equation*}
        \masE [U_{0, b}] \leq \frac{1}{b} \masE Y_n \leq \frac{1}{b} \masE X_n,
    \end{equation*}
    gdje zadnja nejednakost slijedi iz teorema \ref{tm:24.1}.
\end{proof}

Za sljede\' ci teorem uo\v cimo da za niz $\niz{x_n}{n \in \nat} \subseteq \real$ vrijedi
\begin{equation}    \label{jed:24.3}
    \begin{matrix}
        (X_n) \textnormal{ ne konvergira}\\
        \textnormal{u } \extReal
    \end{matrix}
    \quad \iff \quad
    \begin{matrix}
        \textnormal{postoje } a, b \in \masQ, \; a < b\\
        \liminf x_n \leq a < b \leq \limsup x_n
    \end{matrix}.
\end{equation}

\begin{tm}[O konvergenciji submartingala]   \label{tm:24.4}
    \quad \\
    Neka je $\niz{X_n}{n \in \nat}$ submartingal u odnosu na filtraciju $\indFamilija{\famF_n}{n \in \nat}$.
    Ako je
    \begin{equation*}
        \sup \: \bigIndFamilija{\masE [ X_n^+]}{n \in \nat} < +\infty,
    \end{equation*}
    tada postoji $X_\infty \in L^1(\masP)$, takav da je
    \begin{equation*}
        \lim\limits_{n \to \infty} X_n = X_\infty \; (g.s.).
    \end{equation*}
\end{tm}

\begin{proof}
    Ako za neke $a < b$, vrijedi
    \begin{equation*}
        \masP \bigNiz{\omega \in \Omega}{\liminf\limits_{n \to \infty} X_n (\omega) \leq a < b \leq \limsup\limits_{n \to \infty} X_n (\omega) } > 0,
    \end{equation*}
    tada vrijedi $U_{a b} = +\infty$, za cijeli niz.
    Uo\v cimo da je
    \begin{equation*}
        U_{a b} = \lim\limits_{n \to \infty} U_{a b ; n}.
    \end{equation*}
    Budu\' ci je niz $\niz{U_{a b; n}}{n \in \nat}$ rastu\' c vrijedi
    \begin{equation*}
        \masE [U_{a b}] = \lim\limits_{n \to \infty} \masE [U_{a b; n}].
    \end{equation*}
    No, imamo
    \begin{equation*}
        \masE [U_{a b; n}] \leq \frac{1}{b - a} \masE [(X_n - a)^+] \leq \frac{1}{b - a} \Big( \sup\limits_{n \in \nat} \: \masE [X_n^+] + a^- \Big) < +\infty,
    \end{equation*}
    % ovaj dio mi nije jasan :/
    \v sto je kontradikcija.

    Po \eqref{jed:24.3} postoji limes gotovo sigurno i to je $X_\infty$.
    Uo\v cimo
    \begin{equation*}
        |X_n| = X_n^+ + X_n^- = 2 \cdot X_n^+ - X_n^- .
    \end{equation*}
    Budu\' ci je $(X_n)$ submartingal, vrijedi $\masE X_n \geq \masE X_1$, odakle imamo
    \begin{equation*}
        \masE [|X_n|] \leq 2 \sup\limits_{n \in \nat} \: \masE [X_n^+] - \masE X_1 < +\infty,
    \end{equation*}
    pa prema Fatuovoj lemi imamo
    \begin{equation*}
        \masE [|X_\infty|] \leq \liminf\limits_{n \to \infty} \masE [|X_n|] \leq 2 \sup\limits_{n \in \nat} \: \masE [X_n^+] - \masE X_1 < +\infty.
    \end{equation*}
\end{proof}

\begin{zad} \label{zad:24.5}
    \begin{enumerate}[label=(\alph*)]
        \item \label{zad:24.5.1}
        Formulirajte i doka\v zite teorem konvergencije za supermartingale.
        \item \label{zad:24.5.2}
        Formulirajte i doka\v zite teorem konvergencije za submartingale u slu\v caju
        \begin{equation*}
            T = \{ \ldots, -n, \ldots, -1, 0 \}.
        \end{equation*}
        Opi\v site posebno slu\v caj martingala.
    \end{enumerate}
\end{zad}