% o egzistenciji i vjerojatnosti vjerojatnosne mjere

\chapter{Egzistencija i jedinstvenst vjerojatnosti}

Mo\v zemo li u ovoj poop\' cenoj situacij dobro modelirati primjer \ref{pr:1.18}?
Ovo pitanje nas vodi na pitanje egzistencije (a time i jedinstvenosti) vjerojatnosti.
Budu\' ci je vjerojatnost poseban slu\v caj mjere, teoremi iz teorije mjere vrijedi i ovdje.
Podsjetimo se.

Najmanja $\sigma$-algebra na nepraznom skupu $\Omega$ je $\{\varnothing, \Omega\}$, a najve\' ca $\sigma$-algebra je $\partitive{\Omega}$.
Dakle svaka familija $\E \subseteq \partitive{\Omega}$ je sadr\v zana u barem jednoj $\sigma$-algebri na $\Omega$.
Lako se vidi da je presjek neprazne familije $\sigma$-algebri ponovo $\sigma$-algebra, pa je i
\begin{equation} \label{jed:2.1}
    \sigAlg{\famE} := \presjek{
        \begin{smallmatrix}
            \famE \subseteq \famH \subseteq \partitive{\Omega}\\
            \famH \; \sigma \textnormal{-algebra}
        \end{smallmatrix}
    }{} \famH
\end{equation}

tako\dj er $\sigma$-algebra i to najmanje $\sigma$-algebra koja sadr\v zi $\E$ (ka\v zemo jo\v s da je $\sigma$-algebra $\sigAlg{\E}$, $\sigma$-algebra generirana s $\E$).
O\v cito je $\sigAlg{\{\Omega\}} = \{ \varnothing, \; \Omega\}$,
te tako\dj er $\sigAlg{\{A\}} = \{ \varnothing, \; A, \; A^c, \; \Omega \}$.

\begin{zad} \label{zad:2.2}
    Neka je $\famE = \indFamilija{\{ \omega \}}{\omega \in \Omega}$.
    Tada je $\sigAlg{\famE} =\{ A \subseteq \Omega \: |$ $A$ ili $A^c$ prebrojiv $\}$. Tada je $\sigAlg{\famE} = \partitive{\Omega}$ ako i samo ako je $\Omega$ kona\v can ili prebrojiv.
\end{zad}

\begin{rj}
    Zadatak se zapravo sastoji od dvije tvrdnje:
    \begin{enumerate}[label=(\arabic*)]
        \item \label{rj:2.2a}
        $\sigAlg{\famE} = \skup{A \subseteq \Omega}{\card{A} \land \card{A^c} \leq \aleph_0}$, odnosno $A$ ili $A^c$ moraju biti najvi\v se prebrojivi. Budu\' ci da je u tom slu\v caju
        \item   \label{rj:2.2b}
        $\sigAlg{\famE} = \partitive{\Omega}$, ako i samo ako je $\Omega$ najvi\v se prebrojiv.
    \end{enumerate}
    Primjetimo da \ref{rj:2.2b} o\v cito vrijedi za kona\v cne i prebrojive $\Omega$, zato \v sto svaki podskup od $\Omega$ nu\v zno mora biti kona\v can ili prebrojiv, a kako je $\partitive{\Omega}$ $\sigma$-algebra, onda je i skup $\skup{A \subseteq \Omega}{\card{A} \land \card{A^c} \leq \aleph_0}$ $\sigma$-algebra, dakle vrijedi i \ref{rj:2.2a}.

    Dakle promatrajmo neprebrojiv slu\v caj.
    Ozna\v cimo $\famF := \skup{A \subseteq \Omega}{\card{A} \land \card{A^c}}$, te doka\v zimo da je $\famF$ $\sigma$-algebra.
    \begin{enumerate}[label=(\roman*)]
        \item O\v cito je $\varnothing \in \famF$
        \item $A \in \famF$ ako i samo ako je $A$ najvi\v se prebrojiv ili je $A^c$ najvi\v se prebrojiv.
        Vidimo da je uvijet simetri\v can s obzirom na operaciju uzimanja komplementa, stoga slijedi da je $A^c \in \famF$
        \item Neka je $\niz{A_n}{n \in \nat}$ elemenata iz $\famF$, promatramo dvije mogu\' cnosti:
        \begin{enumerate}[label=\arabic*$\degree$)]
            \item Za svaki $n \in \nat$ je $A_n$ najvi\v se prebrojiv, tada je $\unija{n \in \nat}{} A_n$ najvi\v se prebrojiva, pa je $\unija{n \in \nat}{} A_n \in \famF$.
            \item Postoji $n_0 \in \nat$ takav da je $A_{n_0}^c$ najvi\v se prebrojiv.
            Tada je $A_{n_0} \subseteq \unija{n \in \nat}{} A_n$, pa je $\Big( \unija{n \in \nat}{} A_n \Big)^c = \presjek{n \in \nat}{} A_n^c \subseteq A_{n_0}^c$, stoga je $\Big( \unija{n \in \nat}{} A_n \Big)^c$ najvi\v se prebrojiv, pa je $\unija{n \in \nat}{} A_n \in \famF$
        \end{enumerate}
    \end{enumerate}
    Dakle $\famF$ je $\sigma$-algebra.

    Doka\v zimo sada tvrdnju \ref{rj:2.2b}, dovoljan uvijet smo pokazali, ostao je jo\v s nu\v zan.
    Preciznije, treba pokazati da $\sigAlg{\famE} = \partitive{\Omega} \implies$ $\Omega$ najvi\v se prebrojiv.
    Dokazujemo tvrdnju obratom po kontrapoziciji, to jest dokazujemo tvrdnju:\\
    $\Omega$ neprebrojiv $\implies \sigAlg{\famE} \neq \partitive{\Omega}$.

    Za svaka dva beskona\v cna kardinalna broja njihova suma (koja zapravo odgovara njihovoj disjunktnoj uniji) je maksimum ta dva broja.
    Ako je $S$ skup sa kardinalnim brojem $\alpha$, tada vrijedi da je $\alpha + \alpha = \alpha$.
    Dakle postoje dva disjunktna skupa $S_1$, $S_2$, takvi da je njihova unija iste kardinalnosti kao i $S$.
    Postoji bijekcija $f: S_1 \cup S_2 \to S$, takvi da su $f(S_1)$ i $f(S_2)$ disjunktni, neprebrojivi podskupovi od $S$. Konstruirajmo je.

    Neka je $\famF$ familija svih bijekcija sa nekog (proizvoljnog) $T \subseteq S$ u $T \times \{0, \; 1\}$.
    To\v cnije:
    \begin{equation*}
        \famF = \skup{f: T \to T \times \{0, \; 1\}}{T \subseteq S, \; f \textnormal{ je bijekcija}}
    \end{equation*}
    Takva bijekcija uvijek postoji kada je $T$ prebrojiv skup.
    Uredimo te funkcije relacijom "$\subseteq$" na njihovim grafovima.
    Sada po Zornovoj lemi nu\v zno mora postojati maksimalni element, to jest funkcija neka $f_0: T_0 \to T_0 \times \{0, \; 1\}$.
    Kada bi $S \setminus T_0$ bio beskona\v can, tada bi on sadr\v zavao prebrojiv podskup, te bi funkciju $f_0$ mogli pro\v siriti, \v sto je kontradikcija s maksimalno\v scu.
    Dakle $S \setminus T_0$ je kona\v can, pa postoji bijekcija $g: \{1, \; 2, \ldots n\} \to S \setminus T_0 \times \{0, \; 1\}$.
    Neka je $A = \indFamilija{x_n}{n \in \nat} \subseteq S$ prebrojiva familija, mo\v zemo konstruirati novu bijekciju
    $f : S \to S \times \{0, \; 1\}$ sa:
    \begin{equation*}
        f(x) :=
        \begin{cases}
            g(m)    &, x_m \in \{ x_1, \; x_2, \ldots, x_n \} \subseteq A\\
            f_0(x_{m - n})  &, x_m \in A \; \land \; m > n\\
            f_0(x)  &, \textnormal{ina\v ce}
        \end{cases}.
    \end{equation*}
    Dakle ako je $\Omega$ neprebrojiv, mogu\' ce ga je particionirati na dva neprebrojiva disjunktan skupa $\Omega = S_1 \dot{\cup} S_2$, tada je $S_1^c = S_2$, te je $S_1 \in \partitive{\Omega}$, a tako\dj er $S_1 \neq \famF$.
\end{rj}


\begin{defn}
    Ako je $\topProstor$ topolo\v ski prostor s topologijom $\famT$, tada $\sigAlg{\famT}$ ozna\v cavamo s $\borel{X}$ i nazivamo $\sigma$-algebrom \emph{Borelovih skupova}.        
\end{defn}

\begin{pr}  \label{pr:2.3}
    Ako je $X = \R$ ili je $X = \segment{A}{B}$, za $A, \: B \in \R$, $A < B$, s euklidskom topologijom, onda se $\borel{X}$ mo\v ze prikazati kao $\sigAlg{\E}$, za razne familije $\E$.
    Na primjer za $\E$ mo\v zemo uzeti
    \begin{itemize}
        \item $\famI := \skup{\lijInt{a}{b} \cap X}{a < b, \:
            a, \: b \in \R} \bigcup \{\varnothing\}$
        \item $\famI_{\Q} := \skup{\lijInt{a}{b} \cap X}{a < b,
            \: a, \: b \in \Q} \bigcup \{ \varnothing \}$
        \item $\famO_{\Q} := \skup{\obInt{a}{b} \cap X}{a < b,
            \: a, \: b \in \Q} \bigcup \{ \varnothing \}$
        \item $\famK := \skup{\lijInt{-\infty}{b} \cap X}{b
            \in \R}$
        \item $\famK_{\Q} := \skup{\lijInt{-\infty}{b}
            \cap X}{b \in \Q}$.
    \end{itemize}
\end{pr}

Sve familije u primjeru \ref{pr:2.3} imaju zanimljivo svojstvo:
\begin{equation}    \label{jed:2.4}
    A, \: B \in \E \implies A \cap B \in \E.
\end{equation}

Svaka neprazna familija koja ima svojstvo \eqref{jed:2.4} naziva se \emph{$\pi$-sistem}.

Svaka familija $\E \subseteq \partitive{\Omega}$, Koja sadr\v zi $\Omega$, zatvorena je na prave skupovne razlike i rastu\' ce prebrojive unije naziva se \emph{Dynkinovom klasom}.

\begin{nap}
    Familija $\famD \subseteq \partitive{\Omega}$ je dakle Dynkinova klasa ako vrijedi:
    \begin{enumerate}[label=(\roman*)]
        \item $\Omega \in \famD$
        \item $A, \; B \in \famD, \; B \subseteq A \implies A \setminus B \in \famD$
        \item $A_1 \subseteq A_2 \subseteq \ldots \in \famD \implies \unija{n \in \nat}{} A_n \in \famD$.
    \end{enumerate} 
\end{nap}

Presjek Dynkinovih klasa je Dynkinova klasa.
Svaka $\sigma$-algebra je i $\pi$-sistem i Dynkinova klasa.
Posebno $\partitive{\Omega}$ je Dynkinova klasa, pa se kao i u \eqref{jed:2.1} mo\v ze napraviti najmanja Dynkinova klasa generirana klasom $\E$; oznaka je $\dynk{\famE}$.
Iz teorije mjere poznat nam je sljede\' ci zadatak.

\begin{zad}   \label{zad:2.5}
    Neka je $\famE$, $\pi$-sistem na $\Omega$.
    Tada je $\sigAlg{\famE} = \dynk{\famE}$.    
\end{zad}

%
%  rjeÅ¡i zadatak
%

\begin{tm}  \label{tm:2.6}
    Neka je $\izmjerivProstor$ izmjeriv prostor i $\famE$ $\pi$-sistem na $\Omega$ sa svojstvom $\F = \sigAlg{\famE}$.
    Ako su $\mu$ i $\nu$ kona\v cne pozitivne mjere na $\izmjerivProstor$ takve da je $\mjera{\Omega} = \nu(\Omega)$ i $\restr{\mu}{\famE} = \restr{\nu}{\famE}$, tada je $\mu = \nu$.   
\end{tm}

\begin{proof}
    Neka je $\famH := \skup{A \in \F}{\mjera{A} = \nu(A)}$.
    O\v cito je $\famE \subseteq \famH$. S druge strane $\Omega \in \famH$, te je $\famH$ zatvoren rastu\' ce prebrojive unije zbog neprekidnosti pozitivnih mjera na rastu\' ce unije.
    Za $A, \: B \in \famH, \: A \subseteq B$, zbog kona\v cnosti mjera $\mu$ i $\nu$, vrijedi $\mjera{B \setminus A} = \mjera{B} - \mjera{A} = \nu(B) - \nu(A) = \nu(B \setminus A)$.
    Dakle $\famH$ je Dynkinova klasa, pa je $\F = \underbrace{\sigAlg{\E} = \dynk{\famE}}_{\textnormal{zadatak \ref{zad:2.5}}} \subseteq \famH$, to jest $\famF = \famH$.
\end{proof}

\begin{kor} \label{kor:2.7}
    Neka je $\izmjerivProstor$ i $\famE$ $\pi$-sistem na $\Omega$ sa svojstvom $\famF = \sigAlg{\famE}$.
    Ako su $\masP$ i $\overline{\masP}$ dvije vjerojatnosti na $\izmjerivProstor$ takve da je $\restr{\masP}{\famE} = \restr{\overline{\masP}}{\famE}$, tada je $\masP
    = \overline{\masP}$.
\end{kor}

\begin{kor} \label{kor:2.8}
    Neka je $X = \real$ ili $X = \segment{A}{B}$, $A, \; B \in \real, \; A < B$, s euklidskom topologijom.
    Neka su $\masP$ i $\masO$ vjerojatnosti na $\urePar{X}{\borel{X}}$.
    Neka je $\famE$ bilokoja od 5 klasa iz primjera \ref{pr:2.3}.
    Ako je $\restr{\masP}{\famE} = \restr{\masO}{\famE}$, tada je $\masP = \masO$.
\end{kor}

\begin{zad} \label{zad:2.9}
    Neka je $\izmjerivProstor$ izmjeriv prostor i $\famE$ $\pi$-sistem na $\Omega$ sa svojstvom $\famF = \sigAlg{\famE}$.
    Ako su $\mu$ i $\nu$ dvije mjere na $\izmjerivProstor$ takve da je $\restr{\mu}{\famE} = \restr{\nu}{\famE}$ i postoji rastu\' ci niz skupova $\niz{C_n}{n \in \N} \subseteq \famE$ takav da je $\unija{n}{}C_n = \Omega$ i $\mjera{C_n} = \nu(C_n) < +\infty, \;
    \forall n \in \N$, tada je $\mu = \nu$.
\end{zad}

\begin{nap} \label{nap:2.10}
    Grubo govore\' ci ovi rezultati pokazuju da je $\pi$-sistem dovoljno bogata struktura da bi se osigurala jedinstvenost mjere (a time i vjerojatnosti).
    To je vrlo sna\v zan rezultat, budu\' ci da velik broj klasa \v cini $\pi$-sistem, te je lako iz svake klase napraviti $\pi$-sistem; uzme se proizvoljna klasa $\famE \subseteq \partitive{\Omega}$, klasa koja se sastoji iz svih kona\v cnih presjeka elementat iz $\famE$.

    Prirodno je pitanje mo\v ze li se mjera sa $\pi$-sistema pro\v siriti na pripadnu $\sigma$-algebru.
    Uzmemo li klasu $\famK$ iz primjera \ref{pr:2.3} i za svaki $a \in \R_+$ izabermo $\mu_a$ takav da je $\mu_a(A) = a, \; \forall A \in \famK$, takva \' ce funkcija zadovoljavati \eqref{jed:1.11} na $\famK$ (jer na $\famK$ nemamo niti dva disjunktna skupa).
    O\v cito se $\mu_a$ ne mo\v ze pro\v siriti do mjere na $\borel{\R}$.
    Dakle za egzistenciju  (pro\v sirivanje) mjere trebamo ne\v sto bogatiju klasu od $\pi$-sistema.
\end{nap}

Re\' ci cemo da je $\famE \subseteq \partitive{\Omega}$ \emph{poluprsten}
na $\Omega$ ako vrijedi:
\begin{enumerate}[label=(\roman*)]
    \item $\varnothing \in \famE$
    \item $A, \; B \in \famE \implies A \cap B \in \famE$
    \item $A, \: B \in \famE, \: A \subseteq B \implies B \setminus
        A \in \famE$ je kona\v cna disjunktna unija elemenata iz $\famE$.
\end{enumerate}

Osnovni teorem o pro\v sirenju mjere (Caratheodoryjeva konstrukcija) ka\v ze:

\begin{tm}  \label{tm:2.11}
    Neka je $\famE$ poluprsten skupova na nepraznom skupu $\Omega$. Ako je funkcija $\nu: \famE \to [0, \: + \infty]$ $\sigma$-aditivna (u smislu da zadovoljava svojstvo \eqref{jed:1.11} na $\famE$) i $\nu(\varnothing) = 0$, tada postoji mjera $\mu$ na $(\Omega, \: \partitive{\Omega})$, takva da je $\restr{\mu}{\famE} = \nu$.
\end{tm}

\begin{nap} \label{nap:2.12}
    Neka je $\Omega$ neprazan skup, $\famE := \{\varnothing\} \cup \indFamilija{\{ \omega \}}{\omega \in \Omega}$.
    Tada je $\famE$ poluprsten i svaka funkcija $\nu: \famE \to [0, \: +\infty]$ za koju je $\nu(\varnothing) = 0$ je $\sigma$-aditivna;
    preciznije potpuno je opisana familijom "brojeva" $\nu(\{ \omega \}) \in [0, \: +\infty], \; \omega \in \Omega$.

    Po zadatku \ref{zad:2.2} i teoremu \ref{tm:2.11} postoji mjera $\mu$ na $\sigAlg{\famE}$ koja je pro\v sirenje od $\nu$ i za svaki $A \subseteq \Omega$, $A$ prebrojiv je $\mjera{A} = \suma{\omega \in A}{} \nu(\{ \omega \})$.

    ako je i $\Omega$ prebrojiv, onda je ovim pro\v sirenjem jedinstveno odre\dj ena mjera $\mu$ na $\partitive{\Omega}$.
    U su\v stini situacija je sli\v cna kao i u primjeru \ref{pr:1.7} i primjeru \ref{pr:1.14}.
    \v Sto ako je $\Omega$ neprebrojiv?
    %
    % provedi detaljniju analizu
    %
    Pogledajmo dva ekstremna slu\v caja:
    \begin{enumerate}[label=(\roman*)]
        \item $\nu(\{ \omega \}) = 0, \; \forall \omega \in \Omega$.
        Uzmemo bilo koji $c \in \segment{0}{+\infty}$ i defnirajmo $\mu_c$ pomo\' cu
        \begin{equation*}
            \mu_c(A) = 
            \begin{cases}
                0, &A \;\; \textnormal{prebrojiv}\\
                c, &A^c \;\; \textnormal{prebrojiv}
            \end{cases}
        \end{equation*}
        Svaki $\mu_c$ je pro\v sirenje od $\nu$.
        Uo\v cimo da uvijeti iz zadatka \ref{zad:2.9} nisu ispunjeni pa nema jedinstvenosti pro\v sirenja.
        Ako je $\Omega = \segment{a}{b}, \; \sigAlg{\E} \subsetneq \borel{\Omega}$ i pro\v sirenje sa $\E$ na $\borel{\Omega}$ ne vodi ka nekoj konkretnoj mjeri.
        \item Ako je $\nu(\{\omega\}) > 0, \; \forall \omega \in \Omega$ Onda postoji $\varepsilon > 0$ takav da za neprebrojivo $\omega$ iz zadanog neprebrojivog skupa imamo $\nu(\{\omega\}) \geq \varepsilon$.
        Posebno, to zna\v ci da je $\mjera{A} = +\infty$ za svaki $A$, za koji je $A^c$ prebrojiv.
        Ponovo ne osobito korisna konstrukcija.
    \end{enumerate}
\end{nap}

U slu\v caju $X = \R$ ili $X = \segment{A}{B}$, kao i u drugim neprebrojivim slu\v cajevima korisniji je sljede\' ci postupak.
Neka je $\mu$ (pozitivna) mjera na $(\R, \: \borel{\R})$, takva da je $\mjera{K} < +\infty$, za svaki kompaktan skup $K \subseteq \R$ (posebno, takva mjera je \emph{regularna}).
Budu\' ci da je za $a < 0$ (i za $b \geq 0$) skup $\lijInt{a}{0}$ ($\lijInt{0}{b}$), sadr\v zan u kompaktu, sljede\' ca definicija opisuje neopdaju\' cu funkciju $F_{\mu}: \R \to \R$ danu sa
\begin{equation}    \label{jed:2.13}
    F_{\mu}(x) :=
        \begin{cases}
            \mjera{\lijInt{0}{x}}, &x > 0\\
            0,   &x = 0\\
            - \mjera{\lijInt{x}{0}}, &x < 0.
        \end{cases}
\end{equation}
Uo\v cimo da je za svaki $a, \: b \in \R, \: a < b$,
\begin{equation}    \label{jed:2.14}
    \mjera{\lijInt{a}{b}} = F_{\mu}(b) - F_{\mu}(a).
\end{equation}

\begin{zad} \label{zad:2.15}
    Doka\v zite da je $F_{\mu}$ neopadaju\' ca neprekidna zdesna i da postoje (u skupu $\overline{\R}$).
    \begin{align*}
        F_{\mu}(-\infty) :=& \lim_{x \searrow -\infty} F_{\mu}(x)\\
        F_{\mu}(+\infty) :=& \lim_{x \nearrow +\infty} F_{\mu}(x).
    \end{align*}
\end{zad}

Neka je sada $F$ funkcija sa svojstvima iz zadatka \ref{zad:2.15}.
Pomo\' cu \eqref{jed:2.14} definiramo "mjeru" $\mu$ na klasi $\mathcal{I}$ iz primjera \eqref{pr:2.3}.
Nije te\v sko pokazati da je $\mu$ $\sigma$-aditivna na $\mathcal{I}$, pa prema teoremu \ref{tm:2.11} i zadatku \ref{zad:2.9} postoji jedinstveno pro\v sirenje od $\mu$ na $\borel{\R}$ koje daje regularnu mjeru $\mu$.
Za funkciju $F(x) = x$ ova konstrukcija daje tako zvanu \emph{Lebesgue-ovu mjeru} $\lambda$ \v cija restrikcija na $\borel{\segment{0}{1}}$ zadovoljava primjer \ref{pr:1.18}.
Uo\v cimo da funkcije s istim prirastima \eqref{jed:2.14} daju istu mjeru.